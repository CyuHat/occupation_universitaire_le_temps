---
title: "Le traitement des occupations universitaires par le Temps"
author: "Vestin Hategekimana & Nicolas Oclei"
format: 
  html:
    page-layout: full
editor: visual
---

```{r}
#| warning: false
#| message: false
#| echo: false
# Libraries ----
library(tidyverse, DT)
source("Script/utilities.R")

# Options ----
span <- function(x, color="blue"){
  str_c('<span style="color:', color, '">', x, "</span>")
}

remove_long <- function(text){
  if_else(
    str_length(text) > 120 | str_length(text) < 3,
    "",
    text
  )
}

# data ----
df2 <- read_rds("MyData/df2.rds")

max_date <- max(df2$date)
min_date <- min(df2$date)
```


## Tableau des articles du `r stamp("1 Mai 2024")(min_date)` au `r stamp("1 Mai 2024")(max_date)`

```{r}
#| warning: false
#| message: false
#| echo: false

# Tableau
tableau <- 
  df2 %>% 
  arrange(titre, desc(type), desc(position), desc(ton)) %>% 
  group_by(titre) %>%
  slice_head(n=1) %>%
  ungroup() %>%
  select(titre, date, url=lien, auteur, type, lieu, acteurs, critique, position) %>%
  mutate(
    url = str_c(
      '<a href="',
      url,
      '">lien</a>'
    ),
    # url = map(url, html),
    # texte = str_trunc(texte, 60),
    position = case_match(
      position,
      "pour" ~ span("pour", "green"),
      "contre" ~ span("contre", "red"),
      .default = span(position, "blue")
    ),
    across(type:position, remove_long)
    # position = map(position, html)
  ) %>% 
  distinct() %>% 
  arrange(date)

tableau %>% 
  DT::datatable(escape = FALSE)
```

------------------------------------------------------------------------

## Articles de Laure Lugon Zugravu

```{r}
#| warning: false
#| message: false
#| echo: false

tableau %>% 
  filter(str_detect(auteur, "Zugravu")) %>% 
  DT::datatable(escape = FALSE)
```
